#include <iostream>

#include "window.hpp"
#include "renderer.hpp"
#include "script.hpp"

using namespace std;

int main()
{
    Window win(500, 500);
    Renderer r(win);
    Graphics3D g3d;

    g3d.setAmbient(.6, .6, .6);
    g3d.setDiffuse(.1, .1, .1);
    g3d.setSpecular(.25, .25, .25);

    win.invertY();

    g3d.addPolygon(0.325220, -0.001675, 0.107861,
                   0.242718, 0.051778, 0.142315,
                   0.223501, 0.017469, 0.096135);
    g3d.addPolygon(-0.226728, 0.925546, -0.351307,
                   -0.841310, 0.665249, -0.138173,
                   -0.614209, 0.982579, 0.229637);
    g3d.addPolygon(-0.703126, 0.790439, 0.384934,
                   -0.841310, 0.665249, -0.138173,
                   -0.914255, 0.413511, -0.122424);
    g3d.addPolygon(0.325220, -0.001675, 0.107861,
                   0.223501, 0.017469, 0.096135,
                   0.245230, 0.003258, 0.041317);
    g3d.addPolygon(-0.226728, 0.925546, -0.351307,
                   -0.708397, 0.500397, -0.630835,
                   -0.841310, 0.665249, -0.138173);
    g3d.addPolygon(-0.914255, 0.413511, -0.122424,
                   -0.708397, 0.500397, -0.630835,
                   -0.675528, 0.257382, -0.724666);
    g3d.addPolygon(0.325220, -0.001675, 0.107861,
                   0.245230, 0.003258, 0.041317,
                   0.295178, 0.017469, 0.009975);
    g3d.addPolygon(-0.226728, 0.925546, -0.351307,
                   -0.293329, 0.584592, -0.959753,
                   -0.708397, 0.500397, -0.630835);
    g3d.addPolygon(-0.675528, 0.257382, -0.724666,
                   -0.293329, 0.584592, -0.959753,
                   -0.126788, 0.413511, -1.069007);
    g3d.addPolygon(0.325220, -0.001675, 0.107861,
                   0.295178, 0.017469, 0.009975,
                   0.344085, 0.051778, 0.020467);
    g3d.addPolygon(-0.226728, 0.925546, -0.351307,
                   0.160753, 0.868513, -0.932252,
                   -0.293329, 0.584592, -0.959753);
    g3d.addPolygon(-0.126788, 0.413511, -1.069007,
                   0.160753, 0.868513, -0.932252,
                   0.410521, 0.790439, -0.953737);
    g3d.addPolygon(0.325220, -0.001675, 0.107861,
                   0.344085, 0.051778, 0.020467,
                   0.363302, 0.086086, 0.066648);
    g3d.addPolygon(-0.226728, 0.925546, -0.351307,
                   0.387853, 1.185843, -0.564442,
                   0.160753, 0.868513, -0.932252);
    g3d.addPolygon(0.410521, 0.790439, -0.953737,
                   0.387853, 1.185843, -0.564442,
                   0.621650, 1.167367, -0.446378);
    g3d.addPolygon(0.325220, -0.001675, 0.107861,
                   0.363302, 0.086086, 0.066648,
                   0.341573, 0.100297, 0.121465);
    g3d.addPolygon(-0.226728, 0.925546, -0.351307,
                   0.254940, 1.350694, -0.071780,
                   0.387853, 1.185843, -0.564442);
    g3d.addPolygon(0.621650, 1.167367, -0.446378,
                   0.254940, 1.350694, -0.071780,
                   0.382923, 1.323496, 0.155864);
    g3d.addPolygon(0.325220, -0.001675, 0.107861,
                   0.341573, 0.100297, 0.121465,
                   0.291625, 0.086086, 0.152808);
    g3d.addPolygon(-0.226728, 0.925546, -0.351307,
                   -0.160128, 1.266499, 0.257138,
                   0.254940, 1.350694, -0.071780);
    g3d.addPolygon(0.382923, 1.323496, 0.155864,
                   -0.160128, 1.266499, 0.257138,
                   -0.165818, 1.167367, 0.500205);
    g3d.addPolygon(0.325220, -0.001675, 0.107861,
                   0.291625, 0.086086, 0.152808,
                   0.242718, 0.051778, 0.142315);
    g3d.addPolygon(-0.226728, 0.925546, -0.351307,
                   -0.614209, 0.982579, 0.229637,
                   -0.160128, 1.266499, 0.257138);
    g3d.addPolygon(-0.165818, 1.167367, 0.500205,
                   -0.614209, 0.982579, 0.229637,
                   -0.703126, 0.790439, 0.384934);
    g3d.addPolygon(-0.375954, 0.806966, 0.732025,
                   -0.645626, 0.596521, 0.550604,
                   0.242718, 0.051778, 0.142315);
    g3d.addPolygon(-0.375954, 0.806966, 0.732025,
                   -0.430194, 0.898084, 0.686902,
                   -0.670151, 0.637721, 0.530201);

    g3d.addPolygon(-0.375954, 0.806966, 0.732025,
                   -0.670151, 0.637721, 0.530201,
                   -0.645626, 0.596521, 0.550604);
    g3d.addPolygon(-0.703126, 0.790439, 0.384934,
                   -0.670151, 0.637721, 0.530201,
                   -0.430194, 0.898084, 0.686902);
    g3d.addPolygon(0.302320, 1.139878, 0.588962,
                   -0.052414, 1.012666, 0.677867,
                   0.291625, 0.086086, 0.152808);
    g3d.addPolygon(0.302320, 1.139878, 0.588962,
                   0.248080, 1.230996, 0.543840,
                   -0.076939, 1.053865, 0.657465);

    g3d.addPolygon(0.302320, 1.139878, 0.588962,
                   -0.076939, 1.053865, 0.657465,
                   -0.052414, 1.012666, 0.677867);
    g3d.addPolygon(-0.165818, 1.167367, 0.500205,
                   -0.076939, 1.053865, 0.657465,
                   0.248080, 1.230996, 0.543840);
    g3d.addPolygon(0.794120, 1.139878, -0.002211,
                   0.553418, 1.185038, 0.297700,
                   0.341573, 0.100297, 0.121465);
    g3d.addPolygon(0.794120, 1.139878, -0.002211,
                   0.739880, 1.230996, -0.047334,
                   0.528893, 1.226238, 0.277298);

    g3d.addPolygon(0.794120, 1.139878, -0.002211,
                   0.528893, 1.226238, 0.277298,
                   0.553418, 1.185038, 0.297700);
    g3d.addPolygon(0.382923, 1.323496, 0.155864,
                   0.528893, 1.226238, 0.277298,
                   0.739880, 1.230996, -0.047334);
    g3d.addPolygon(0.811356, 0.806966, -0.695194,
                   0.816983, 1.012666, -0.367201,
                   0.363302, 0.086086, 0.066648);
    g3d.addPolygon(0.811356, 0.806966, -0.695194,
                   0.757116, 0.898084, -0.740317,
                   0.792458, 1.053865, -0.387603);

    g3d.addPolygon(0.811356, 0.806966, -0.695194,
                   0.792458, 1.053865, -0.387603,
                   0.816983, 1.012666, -0.367201);
    g3d.addPolygon(0.621650, 1.167367, -0.446378,
                   0.792458, 1.053865, -0.387603,
                   0.757116, 0.898084, -0.740317);
    g3d.addPolygon(0.343931, 0.336157, -1.084047,
                   0.583888, 0.596521, -0.927346,
                   0.344085, 0.051778, 0.020467);
    g3d.addPolygon(0.343931, 0.336157, -1.084047,
                   0.289691, 0.427276, -1.129169,
                   0.559363, 0.637721, -0.947748);

    g3d.addPolygon(0.343931, 0.336157, -1.084047,
                   0.559363, 0.637721, -0.947748,
                   0.583888, 0.596521, -0.927346);
    g3d.addPolygon(0.410521, 0.790439, -0.953737,
                   0.559363, 0.637721, -0.947748,
                   0.289691, 0.427276, -1.129169);
    g3d.addPolygon(-0.334343, 0.003245, -0.940985,
                   -0.009324, 0.180377, -1.054610,
                   0.295178, 0.017469, 0.009975);
    g3d.addPolygon(-0.334343, 0.003245, -0.940985,
                   -0.388583, 0.094364, -0.986107,
                   -0.033849, 0.221576, -1.075012);

    g3d.addPolygon(-0.334343, 0.003245, -0.940985,
                   -0.033849, 0.221576, -1.075012,
                   -0.009324, 0.180377, -1.054610);
    g3d.addPolygon(-0.126788, 0.413511, -1.069007,
                   -0.033849, 0.221576, -1.075012,
                   -0.388583, 0.094364, -0.986107);
    g3d.addPolygon(-0.826143, 0.003245, -0.349811,
                   -0.615156, 0.008004, -0.674443,
                   0.245230, 0.003258, 0.041317);
    g3d.addPolygon(-0.826143, 0.003245, -0.349811,
                   -0.880383, 0.094364, -0.394934,
                   -0.639681, 0.049203, -0.694845);

    g3d.addPolygon(-0.826143, 0.003245, -0.349811,
                   -0.639681, 0.049203, -0.694845,
                   -0.615156, 0.008004, -0.674443);
    g3d.addPolygon(-0.675528, 0.257382, -0.724666,
                   -0.639681, 0.049203, -0.694845,
                   -0.880383, 0.094364, -0.394934);
    g3d.addPolygon(-0.843379, 0.336158, 0.343172,
                   -0.878721, 0.180377, -0.009541,
                   0.223501, 0.017469, 0.096135);
    g3d.addPolygon(-0.843379, 0.336158, 0.343172,
                   -0.897619, 0.427276, 0.298049,
                   -0.903246, 0.221576, -0.029944);

    g3d.addPolygon(-0.843379, 0.336158, 0.343172,
                   -0.903246, 0.221576, -0.029944,
                   -0.878721, 0.180377, -0.009541);
    g3d.addPolygon(-0.914255, 0.413511, -0.122424,
                   -0.903246, 0.221576, -0.029944,
                   -0.897619, 0.427276, 0.298049);
    g3d.addPolygon(-0.645626, 0.596521, 0.550604,
                   -0.670151, 0.637721, 0.530201,
                   -0.897619, 0.427276, 0.298049);

    g3d.addPolygon(-0.645626, 0.596521, 0.550604,
                   -0.897619, 0.427276, 0.298049,
                   -0.843379, 0.336158, 0.343172);
    g3d.addPolygon(-0.878721, 0.180377, -0.009541,
                   -0.903246, 0.221576, -0.029944,
                   -0.880383, 0.094364, -0.394934);

    g3d.addPolygon(-0.878721, 0.180377, -0.009541,
                   -0.880383, 0.094364, -0.394934,
                   -0.826143, 0.003245, -0.349811);
    g3d.addPolygon(-0.615156, 0.008004, -0.674443,
                   -0.639681, 0.049203, -0.694845,
                   -0.388583, 0.094364, -0.986107);

    g3d.addPolygon(-0.615156, 0.008004, -0.674443,
                   -0.388583, 0.094364, -0.986107,
                   -0.334343, 0.003245, -0.940985);
    g3d.addPolygon(-0.009324, 0.180377, -1.054610,
                   -0.033849, 0.221576, -1.075012,
                   0.289691, 0.427276, -1.129169);

    g3d.addPolygon(-0.009324, 0.180377, -1.054610,
                   0.289691, 0.427276, -1.129169,
                   0.343931, 0.336157, -1.084047);
    g3d.addPolygon(0.583888, 0.596521, -0.927346,
                   0.559363, 0.637721, -0.947748,
                   0.757116, 0.898084, -0.740317);

    g3d.addPolygon(0.583888, 0.596521, -0.927346,
                   0.757116, 0.898084, -0.740317,
                   0.811356, 0.806966, -0.695194);
    g3d.addPolygon(0.816983, 1.012666, -0.367201,
                   0.792458, 1.053865, -0.387603,
                   0.739880, 1.230996, -0.047334);

    g3d.addPolygon(0.816983, 1.012666, -0.367201,
                   0.739880, 1.230996, -0.047334,
                   0.794120, 1.139878, -0.002211);
    g3d.addPolygon(0.553418, 1.185038, 0.297700,
                   0.528893, 1.226238, 0.277298,
                   0.248080, 1.230996, 0.543840);

    g3d.addPolygon(0.553418, 1.185038, 0.297700,
                   0.248080, 1.230996, 0.543840,
                   0.302320, 1.139878, 0.588962);
    g3d.addPolygon(-0.052414, 1.012666, 0.677867,
                   -0.076939, 1.053865, 0.657465,
                   -0.430194, 0.898084, 0.686902);

    g3d.addPolygon(-0.052414, 1.012666, 0.677867,
                   -0.430194, 0.898084, 0.686902,
                   -0.375954, 0.806966, 0.732025);
    g3d.addPolygon(0.242718, 0.051778, 0.142315,
                   0.291625, 0.086086, 0.152808,
                   -0.375954, 0.806966, 0.732025);
    g3d.addPolygon(0.291625, 0.086086, 0.152808,
                   -0.052414, 1.012666, 0.677867,
                   -0.375954, 0.806966, 0.732025);
    g3d.addPolygon(-0.430194, 0.898084, 0.686902,
                   -0.076939, 1.053865, 0.657465,
                   -0.165818, 1.167367, 0.500205);
    g3d.addPolygon(-0.165818, 1.167367, 0.500205,
                   -0.703126, 0.790439, 0.384934,
                   -0.430194, 0.898084, 0.686902);
    g3d.addPolygon(0.291625, 0.086086, 0.152808,
                   0.341573, 0.100297, 0.121465,
                   0.302320, 1.139878, 0.588962);
    g3d.addPolygon(0.341573, 0.100297, 0.121465,
                   0.553418, 1.185038, 0.297700,
                   0.302320, 1.139878, 0.588962);
    g3d.addPolygon(0.248080, 1.230996, 0.543840,
                   0.528893, 1.226238, 0.277298,
                   0.382923, 1.323496, 0.155864);
    g3d.addPolygon(0.382923, 1.323496, 0.155864,
                   -0.165818, 1.167367, 0.500205,
                   0.248080, 1.230996, 0.543840);
    g3d.addPolygon(0.341573, 0.100297, 0.121465,
                   0.363302, 0.086086, 0.066648,
                   0.794120, 1.139878, -0.002211);
    g3d.addPolygon(0.363302, 0.086086, 0.066648,
                   0.816983, 1.012666, -0.367201,
                   0.794120, 1.139878, -0.002211);
    g3d.addPolygon(0.739880, 1.230996, -0.047334,
                   0.792458, 1.053865, -0.387603,
                   0.621650, 1.167367, -0.446378);
    g3d.addPolygon(0.621650, 1.167367, -0.446378,
                   0.382923, 1.323496, 0.155864,
                   0.739880, 1.230996, -0.047334);
    g3d.addPolygon(0.363302, 0.086086, 0.066648,
                   0.344085, 0.051778, 0.020467,
                   0.811356, 0.806966, -0.695194);
    g3d.addPolygon(0.344085, 0.051778, 0.020467,
                   0.583888, 0.596521, -0.927346,
                   0.811356, 0.806966, -0.695194);
    g3d.addPolygon(0.757116, 0.898084, -0.740317,
                   0.559363, 0.637721, -0.947748,
                   0.410521, 0.790439, -0.953737);
    g3d.addPolygon(0.410521, 0.790439, -0.953737,
                   0.621650, 1.167367, -0.446378,
                   0.757116, 0.898084, -0.740317);
    g3d.addPolygon(0.344085, 0.051778, 0.020467,
                   0.295178, 0.017469, 0.009975,
                   0.343931, 0.336157, -1.084047);
    g3d.addPolygon(0.295178, 0.017469, 0.009975,
                   -0.009324, 0.180377, -1.054610,
                   0.343931, 0.336157, -1.084047);
    g3d.addPolygon(0.289691, 0.427276, -1.129169,
                   -0.033849, 0.221576, -1.075012,
                   -0.126788, 0.413511, -1.069007);
    g3d.addPolygon(-0.126788, 0.413511, -1.069007,
                   0.410521, 0.790439, -0.953737,
                   0.289691, 0.427276, -1.129169);
    g3d.addPolygon(0.295178, 0.017469, 0.009975,
                   0.245230, 0.003258, 0.041317,
                   -0.334343, 0.003245, -0.940985);
    g3d.addPolygon(0.245230, 0.003258, 0.041317,
                   -0.615156, 0.008004, -0.674443,
                   -0.334343, 0.003245, -0.940985);
    g3d.addPolygon(-0.388583, 0.094364, -0.986107,
                   -0.639681, 0.049203, -0.694845,
                   -0.675528, 0.257382, -0.724666);
    g3d.addPolygon(-0.675528, 0.257382, -0.724666,
                   -0.126788, 0.413511, -1.069007,
                   -0.388583, 0.094364, -0.986107);
    g3d.addPolygon(0.245230, 0.003258, 0.041317,
                   0.223501, 0.017469, 0.096135,
                   -0.826143, 0.003245, -0.349811);
    g3d.addPolygon(0.223501, 0.017469, 0.096135,
                   -0.878721, 0.180377, -0.009541,
                   -0.826143, 0.003245, -0.349811);
    g3d.addPolygon(-0.880383, 0.094364, -0.394934,
                   -0.903246, 0.221576, -0.029944,
                   -0.914255, 0.413511, -0.122424);
    g3d.addPolygon(-0.914255, 0.413511, -0.122424,
                   -0.675528, 0.257382, -0.724666,
                   -0.880383, 0.094364, -0.394934);
    g3d.addPolygon(0.223501, 0.017469, 0.096135,
                   0.242718, 0.051778, 0.142315,
                   -0.843379, 0.336158, 0.343172);
    g3d.addPolygon(0.242718, 0.051778, 0.142315,
                   -0.645626, 0.596521, 0.550604,
                   -0.843379, 0.336158, 0.343172);
    g3d.addPolygon(-0.897619, 0.427276, 0.298049,
                   -0.670151, 0.637721, 0.530201,
                   -0.703126, 0.790439, 0.384934);
    g3d.addPolygon(-0.703126, 0.790439, 0.384934,
                   -0.914255, 0.413511, -0.122424,
                   -0.897619, 0.427276, 0.298049);
    g3d.addPolygon(-0.703126, 0.790439, 0.384934,
                   -0.614209, 0.982579, 0.229637,
                   -0.841310, 0.665249, -0.138173);
    g3d.addPolygon(-0.914255, 0.413511, -0.122424,
                   -0.841310, 0.665249, -0.138173,
                   -0.708397, 0.500397, -0.630835);
    g3d.addPolygon(-0.675528, 0.257382, -0.724666,
                   -0.708397, 0.500397, -0.630835,
                   -0.293329, 0.584592, -0.959753);
    g3d.addPolygon(-0.126788, 0.413511, -1.069007,
                   -0.293329, 0.584592, -0.959753,
                   0.160753, 0.868513, -0.932252);
    g3d.addPolygon(0.410521, 0.790439, -0.953737,
                   0.160753, 0.868513, -0.932252,
                   0.387853, 1.185843, -0.564442);
    g3d.addPolygon(0.621650, 1.167367, -0.446378,
                   0.387853, 1.185843, -0.564442,
                   0.254940, 1.350694, -0.071780);
    g3d.addPolygon(0.382923, 1.323496, 0.155864,
                   0.254940, 1.350694, -0.071780,
                   -0.160128, 1.266499, 0.257138);
    g3d.addPolygon(-0.165818, 1.167367, 0.500205,
                   -0.160128, 1.266499, 0.257138,
                   -0.614209, 0.982579, 0.229637);

    Transform t;
    t.addRotation(-30, Axis::X);
    t.addRotation(65, Axis::Y);
    t.addRotation(-30, Axis::Z);
    t.addDilation(200, 200, 200);
    t.addTranslation(300, 200, 0);

    r.addPlane();
    r.transformPlane(t);

    Color c[] = {Color(161,238,231), Color(219,240,220), Color(74,167,80), Color(219,240,220)};

    for (int i = 0; i < 4; i++)
    {
        double x = cos(1 * 3.1415 * (double)(i) / 4);
        double y = cos(1 * 3.1415 * (double)(i) / 4);

        r.setColor(c[i].getRed(), c[i].getGreen(), c[i].getBlue());
        r.addPointLight(0, y, x);
    }

    // r.setColor(c[0].getRed(), c[0].getGreen(), c[0].getBlue());
    // r.addPointLight(0, 0, 1);

    r.setColor(255, 255, 255);
    r.draw(g3d);

    win.draw("gallery.ppm", false);
    win.display();
}